<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>自评表格 - 可视化展示</title>
    
    <!-- TailwindCSS 3.0+ CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- 自定义样式 -->
    <style>
        /* 平滑滚动 */
        html {
            scroll-behavior: smooth;
        }
        
        /* 自定义滚动条 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(156, 163, 175, 0.5);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(156, 163, 175, 0.7);
        }
        
        /* 淡入动画 */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* 卡片悬停效果 */
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* 按钮悬停效果 */
        .btn-hover {
            transition: all 0.2s ease-in-out;
        }
        
        .btn-hover:hover {
            transform: scale(1.05);
        }
        
        .btn-hover:active {
            transform: scale(0.98);
        }
        
        /* 输入框焦点效果 */
        .input-focus:focus {
            outline: none;
            ring: 2px;
            ring-color: rgba(59, 130, 246, 0.5);
        }
        
        /* 打印样式 */
        @media print {
            .no-print {
                display: none !important;
            }
            
            body {
                background: white !important;
                color: black !important;
            }
            
            .card {
                break-inside: avoid;
                page-break-inside: avoid;
            }
        }
        
        /* 深色模式过渡 */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
    </style>
    
    <script>
        // TailwindCSS 配置
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    
    <!-- 顶部导航栏 -->
    <nav class="sticky top-0 z-50 bg-white/80 dark:bg-gray-800/80 backdrop-blur-md border-b border-gray-200 dark:border-gray-700 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-clipboard-list text-primary-600 dark:text-primary-400 text-xl"></i>
                    <h1 class="text-xl font-semibold">自评表格</h1>
                </div>
                
                <div class="flex items-center space-x-4">
                    <!-- 主题切换按钮 -->
                    <button id="themeToggle" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 btn-hover transition-colors" aria-label="切换主题">
                        <i class="fas fa-moon dark:hidden text-gray-600"></i>
                        <i class="fas fa-sun hidden dark:inline text-yellow-400"></i>
                    </button>
                    
                    <!-- 导出按钮 -->
                    <button id="exportBtn" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg btn-hover font-medium flex items-center space-x-2">
                        <i class="fas fa-download"></i>
                        <span>导出文档</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- 主内容区域 -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- 个人信息卡片 -->
        <div class="mb-8 fade-in">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 card-hover">
                <h2 class="text-2xl font-bold mb-6 flex items-center space-x-2">
                    <i class="fas fa-user-circle text-primary-600 dark:text-primary-400"></i>
                    <span>个人信息</span>
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">姓名</label>
                        <input type="text" id="name" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus" placeholder="请输入姓名">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">部门/岗位</label>
                        <input type="text" id="department" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus" placeholder="请输入部门或岗位">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">日期</label>
                        <input type="date" id="date" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">评价周期</label>
                        <input type="text" id="period" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus" placeholder="例如：2024年第一季度">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 工作表现评估 -->
        <div class="mb-8 fade-in" style="animation-delay: 0.1s">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 card-hover">
                <h2 class="text-2xl font-bold mb-6 flex items-center space-x-2">
                    <i class="fas fa-chart-line text-primary-600 dark:text-primary-400"></i>
                    <span>工作表现评估</span>
                </h2>
                
                <div class="space-y-6">
                    <!-- 工作完成情况 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">工作完成情况</label>
                        <textarea id="workCompletion" rows="4" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请描述您在本周期内的工作完成情况..."></textarea>
                    </div>
                    
                    <!-- 工作质量 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">工作质量</label>
                        <textarea id="workQuality" rows="4" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请评价您的工作质量..."></textarea>
                    </div>
                    
                    <!-- 工作效率 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">工作效率</label>
                        <textarea id="workEfficiency" rows="4" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请评价您的工作效率..."></textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 能力评估 -->
        <div class="mb-8 fade-in" style="animation-delay: 0.2s">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 card-hover">
                <h2 class="text-2xl font-bold mb-6 flex items-center space-x-2">
                    <i class="fas fa-brain text-primary-600 dark:text-primary-400"></i>
                    <span>能力评估</span>
                </h2>
                
                <div class="space-y-6">
                    <!-- 专业技能 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">专业技能</label>
                        <div class="mb-2">
                            <span class="text-sm text-gray-600 dark:text-gray-400">评分：</span>
                            <div class="inline-flex space-x-1 ml-2">
                                <button class="rating-btn" data-rating="1" data-field="skill">1</button>
                                <button class="rating-btn" data-rating="2" data-field="skill">2</button>
                                <button class="rating-btn" data-rating="3" data-field="skill">3</button>
                                <button class="rating-btn" data-rating="4" data-field="skill">4</button>
                                <button class="rating-btn" data-rating="5" data-field="skill">5</button>
                            </div>
                            <span class="text-sm text-gray-500 dark:text-gray-400 ml-2">（1-5分）</span>
                        </div>
                        <textarea id="skillDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请详细描述您的专业技能水平..."></textarea>
                    </div>
                    
                    <!-- 沟通能力 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">沟通能力</label>
                        <div class="mb-2">
                            <span class="text-sm text-gray-600 dark:text-gray-400">评分：</span>
                            <div class="inline-flex space-x-1 ml-2">
                                <button class="rating-btn" data-rating="1" data-field="communication">1</button>
                                <button class="rating-btn" data-rating="2" data-field="communication">2</button>
                                <button class="rating-btn" data-rating="3" data-field="communication">3</button>
                                <button class="rating-btn" data-rating="4" data-field="communication">4</button>
                                <button class="rating-btn" data-rating="5" data-field="communication">5</button>
                            </div>
                            <span class="text-sm text-gray-500 dark:text-gray-400 ml-2">（1-5分）</span>
                        </div>
                        <textarea id="communicationDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请描述您的沟通协作能力..."></textarea>
                    </div>
                    
                    <!-- 学习能力 -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">学习能力</label>
                        <div class="mb-2">
                            <span class="text-sm text-gray-600 dark:text-gray-400">评分：</span>
                            <div class="inline-flex space-x-1 ml-2">
                                <button class="rating-btn" data-rating="1" data-field="learning">1</button>
                                <button class="rating-btn" data-rating="2" data-field="learning">2</button>
                                <button class="rating-btn" data-rating="3" data-field="learning">3</button>
                                <button class="rating-btn" data-rating="4" data-field="learning">4</button>
                                <button class="rating-btn" data-rating="5" data-field="learning">5</button>
                            </div>
                            <span class="text-sm text-gray-500 dark:text-gray-400 ml-2">（1-5分）</span>
                        </div>
                        <textarea id="learningDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请描述您的学习能力和成长情况..."></textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 成就与亮点 -->
        <div class="mb-8 fade-in" style="animation-delay: 0.3s">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 card-hover">
                <h2 class="text-2xl font-bold mb-6 flex items-center space-x-2">
                    <i class="fas fa-trophy text-primary-600 dark:text-primary-400"></i>
                    <span>成就与亮点</span>
                </h2>
                <textarea id="achievements" rows="6" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请列出您在本周期内的主要成就和工作亮点..."></textarea>
            </div>
        </div>
        
        <!-- 不足与改进 -->
        <div class="mb-8 fade-in" style="animation-delay: 0.4s">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 card-hover">
                <h2 class="text-2xl font-bold mb-6 flex items-center space-x-2">
                    <i class="fas fa-lightbulb text-primary-600 dark:text-primary-400"></i>
                    <span>不足与改进</span>
                </h2>
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">存在的不足</label>
                        <textarea id="weaknesses" rows="4" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请客观分析自身存在的不足..."></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">改进计划</label>
                        <textarea id="improvements" rows="4" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请制定具体的改进计划和措施..."></textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 未来规划 -->
        <div class="mb-8 fade-in" style="animation-delay: 0.5s">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 card-hover">
                <h2 class="text-2xl font-bold mb-6 flex items-center space-x-2">
                    <i class="fas fa-road text-primary-600 dark:text-primary-400"></i>
                    <span>未来规划</span>
                </h2>
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">职业发展目标</label>
                        <textarea id="careerGoals" rows="4" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请描述您的职业发展目标..."></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">学习计划</label>
                        <textarea id="learningPlan" rows="4" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="请制定您的学习提升计划..."></textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 其他说明 -->
        <div class="mb-8 fade-in" style="animation-delay: 0.6s">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 card-hover">
                <h2 class="text-2xl font-bold mb-6 flex items-center space-x-2">
                    <i class="fas fa-comments text-primary-600 dark:text-primary-400"></i>
                    <span>其他说明</span>
                </h2>
                <textarea id="otherComments" rows="5" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 input-focus resize-none" placeholder="其他需要说明的内容..."></textarea>
            </div>
        </div>
        
    </main>
    
    <!-- 页脚 -->
    <footer class="bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <p class="text-center text-sm text-gray-600 dark:text-gray-400">
                © 2024 自评表格系统 | 数据仅保存在本地浏览器
            </p>
        </div>
    </footer>
    
    <script>
        // 主题切换功能
        (function() {
            const themeToggle = document.getElementById('themeToggle');
            const html = document.documentElement;
            
            // 检测系统主题偏好
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const savedTheme = localStorage.getItem('theme');
            
            // 应用主题
            function applyTheme(theme) {
                if (theme === 'dark' || (!theme && prefersDark)) {
                    html.classList.add('dark');
                } else {
                    html.classList.remove('dark');
                }
            }
            
            // 初始化主题
            applyTheme(savedTheme || (prefersDark ? 'dark' : 'light'));
            
            // 切换主题
            themeToggle.addEventListener('click', () => {
                const isDark = html.classList.contains('dark');
                const newTheme = isDark ? 'light' : 'dark';
                html.classList.toggle('dark');
                localStorage.setItem('theme', newTheme);
            });
            
            // 监听系统主题变化
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                if (!localStorage.getItem('theme')) {
                    applyTheme(e.matches ? 'dark' : 'light');
                }
            });
        })();
        
        // 评分按钮功能
        document.querySelectorAll('.rating-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const rating = parseInt(this.dataset.rating);
                const field = this.dataset.field;
                const buttons = document.querySelectorAll(`.rating-btn[data-field="${field}"]`);
                
                // 更新按钮状态
                buttons.forEach((b, index) => {
                    if (index < rating) {
                        b.classList.add('bg-primary-600', 'text-white');
                        b.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    } else {
                        b.classList.remove('bg-primary-600', 'text-white');
                        b.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    }
                });
                
                // 保存评分
                localStorage.setItem(`rating_${field}`, rating);
            });
            
            // 初始化评分按钮样式
            btn.classList.add('w-10', 'h-10', 'rounded-lg', 'font-medium', 'btn-hover', 'bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
        });
        
        // 恢复保存的评分
        ['skill', 'communication', 'learning'].forEach(field => {
            const savedRating = localStorage.getItem(`rating_${field}`);
            if (savedRating) {
                const buttons = document.querySelectorAll(`.rating-btn[data-field="${field}"]`);
                buttons.forEach((b, index) => {
                    if (index < parseInt(savedRating)) {
                        b.classList.add('bg-primary-600', 'text-white');
                        b.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    }
                });
            }
        });
        
        // 自动保存功能
        const inputs = document.querySelectorAll('input, textarea');
        inputs.forEach(input => {
            // 恢复保存的数据
            const savedValue = localStorage.getItem(`data_${input.id}`);
            if (savedValue) {
                input.value = savedValue;
            }
            
            // 保存数据
            input.addEventListener('input', function() {
                localStorage.setItem(`data_${this.id}`, this.value);
            });
        });
        
        // 导出功能
        document.getElementById('exportBtn').addEventListener('click', function() {
            // 收集所有数据
            const data = {
                name: document.getElementById('name').value || '未填写',
                department: document.getElementById('department').value || '未填写',
                date: document.getElementById('date').value || new Date().toISOString().split('T')[0],
                period: document.getElementById('period').value || '未填写',
                workCompletion: document.getElementById('workCompletion').value || '未填写',
                workQuality: document.getElementById('workQuality').value || '未填写',
                workEfficiency: document.getElementById('workEfficiency').value || '未填写',
                skillRating: localStorage.getItem('rating_skill') || '未评分',
                skillDescription: document.getElementById('skillDescription').value || '未填写',
                communicationRating: localStorage.getItem('rating_communication') || '未评分',
                communicationDescription: document.getElementById('communicationDescription').value || '未填写',
                learningRating: localStorage.getItem('rating_learning') || '未评分',
                learningDescription: document.getElementById('learningDescription').value || '未填写',
                achievements: document.getElementById('achievements').value || '未填写',
                weaknesses: document.getElementById('weaknesses').value || '未填写',
                improvements: document.getElementById('improvements').value || '未填写',
                careerGoals: document.getElementById('careerGoals').value || '未填写',
                learningPlan: document.getElementById('learningPlan').value || '未填写',
                otherComments: document.getElementById('otherComments').value || '未填写'
            };
            
            // 生成文档内容
            const docContent = `
自评表格

═══════════════════════════════════════════════════════════

【个人信息】
姓名：${data.name}
部门/岗位：${data.department}
日期：${data.date}
评价周期：${data.period}

═══════════════════════════════════════════════════════════

【工作表现评估】

工作完成情况：
${data.workCompletion}

工作质量：
${data.workQuality}

工作效率：
${data.workEfficiency}

═══════════════════════════════════════════════════════════

【能力评估】

专业技能
评分：${data.skillRating}/5
描述：${data.skillDescription}

沟通能力
评分：${data.communicationRating}/5
描述：${data.communicationDescription}

学习能力
评分：${data.learningRating}/5
描述：${data.learningDescription}

═══════════════════════════════════════════════════════════

【成就与亮点】
${data.achievements}

═══════════════════════════════════════════════════════════

【不足与改进】

存在的不足：
${data.weaknesses}

改进计划：
${data.improvements}

═══════════════════════════════════════════════════════════

【未来规划】

职业发展目标：
${data.careerGoals}

学习计划：
${data.learningPlan}

═══════════════════════════════════════════════════════════

【其他说明】
${data.otherComments}

═══════════════════════════════════════════════════════════

导出时间：${new Date().toLocaleString('zh-CN')}
            `.trim();
            
            // 创建并下载文件
            const blob = new Blob(['\ufeff' + docContent], { type: 'text/plain;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `自评表格_${data.name || '未命名'}_${data.date || new Date().toISOString().split('T')[0]}.txt`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // 显示成功提示
            const originalText = this.innerHTML;
            this.innerHTML = '<i class="fas fa-check"></i> <span>导出成功</span>';
            this.classList.add('bg-green-600', 'hover:bg-green-700');
            this.classList.remove('bg-primary-600', 'hover:bg-primary-700');
            
            setTimeout(() => {
                this.innerHTML = originalText;
                this.classList.remove('bg-green-600', 'hover:bg-green-700');
                this.classList.add('bg-primary-600', 'hover:bg-primary-700');
            }, 2000);
        });
        
        // 页面加载动画
        window.addEventListener('load', () => {
            const elements = document.querySelectorAll('.fade-in');
            elements.forEach((el, index) => {
                setTimeout(() => {
                    el.style.opacity = '1';
                }, index * 100);
            });
        });
        
        // 懒加载优化（如果需要加载图片）
        if ('IntersectionObserver' in window) {
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        if (img.dataset.src) {
                            img.src = img.dataset.src;
                            img.removeAttribute('data-src');
                            observer.unobserve(img);
                        }
                    }
                });
            });
            
            document.querySelectorAll('img[data-src]').forEach(img => {
                imageObserver.observe(img);
            });
        }
    </script>
</body>
</html>
